{
  "@context": "https://huijoohwee.github.io/schema/AgenticRAG/v1/context.jsonld",
  "@id": "rag:Panel",
  "@type": "rdfs:Class",
  "schemaVersion": "1.0.11",
  "rdfs:comment": [
    {
      "@value": "Defines reusable panel UI surfaces. Controls that combine icons and text must use stable alignment primitives (inline-flex with centered alignment) and shared icon baseline rules to prevent visual drift across themes and density settings.",
      "@language": "en-us"
    },
    {
      "@value": "定义可复用的面板 UI 表面。图标与文本组合控件必须使用稳定的对齐原语（inline-flex 居中对齐）与共享图标基线规则，避免在主题与密度设置下出现视觉漂移。",
      "@language": "zh-cn"
    }
  ],
  "rdfs:label": [
    { "@value": "Panel", "@language": "en-us" },
    { "@value": "面板", "@language": "zh-cn" }
  ],
  "panelInteractionContracts": {
    "markdownSsotSectionHeader": [
      {
        "@value": "Markdown Editor/Viewer/Presentation must share one-and-only Markdown Section Header implementation. Mode switches may change enabled/disabled state but must not introduce alternate header variants or different button sets.",
        "@language": "en-us"
      },
      {
        "@value": "Markdown Editor/Viewer/Presentation 必须共享唯一的 Markdown 区域头部实现。模式切换只允许改变启用/禁用状态，不得引入不同的头部变体或不同的按钮集合。",
        "@language": "zh-cn"
      }
    ],
    "markdownSsotSidebarStructure": [
      {
        "@value": "Markdown Contents sidebar uses a single SSOT DOM structure (aside/header/nav/sections) with shared micro-label typography. Sidebar section headers are typography-only and must not render action menus; source file actions belong to the section header area only when they are part of the canonical SSOT header contract.",
        "@language": "en-us"
      },
      {
        "@value": "Markdown Contents 侧边栏必须使用唯一的 SSOT DOM 结构（aside/header/nav/sections）并共享微标签排版。侧边栏分区标题仅用于排版显示，不得渲染动作菜单；Source Files 动作应归属于规范的 SSOT 头部契约。",
        "@language": "zh-cn"
      }
    ],
    "markdownRightClickShowOnIn": [
      {
        "@value": "Right Click opens the app-level \"Show on/in …\" toolbar at the exact pointer position; avoid Monaco default context menus so behavior is consistent across Editor/Viewer/Presentation.",
        "@language": "en-us"
      },
      {
        "@value": "右键在指针精确位置打开应用级 \"Show on/in …\" 工具条；避免使用 Monaco 默认菜单以保证 Editor/Viewer/Presentation 行为一致。",
        "@language": "zh-cn"
      }
    ],
    "bottomPanelFlowTab": [
      {
        "@value": "BottomPanel includes a Flow tab adjacent to Status. ui-path-0: Source File click commits GraphData and D3 renders; Flow button opens BottomPanel and Flow renders the same GraphData in a read-only ReactFlow overview plus Graph Data Table (Nodes/Edges scope). Placement must reuse the host layout position cache (or node x/y) and never inject demo data.",
        "@language": "en-us"
      },
      {
        "@value": "BottomPanel 包含一个紧邻 Status 的 Flow 标签页。ui-path-0：点击 Source File 提交 GraphData 并由 D3 渲染；点击 Flow 打开 BottomPanel 并以只读方式用 ReactFlow 渲染同一份 GraphData（含 Graph Data Table：Nodes/Edges scope）。位置必须复用宿主布局位置缓存（或节点 x/y），禁止注入演示数据。",
        "@language": "zh-cn"
      }
    ],
    "toolbarEditorWorkspaceToggle": [
      {
        "@value": "Toolbar includes an Editor button left of Status. Clicking Editor toggles a VS Code-like embedded editor workspace that reuses the canonical Markdown Workspace SSOT and shows a Canvas preview via an iframe URL param contract (e.g. `/?kgPreview=1`) that forces preview-only rendering (no toolbar/panels) to prevent recursion and cross-mode interference. The editor pane may switch between Markdown and a lightweight Graph Table section; selection and focus remain SSOT-aligned.",
        "@language": "en-us"
      },
      {
        "@value": "Toolbar 在 Status 左侧包含 Editor 按钮。点击 Editor 切换到类 VS Code 的内嵌编辑工作区：复用规范的 Markdown Workspace SSOT，并通过 iframe + URL 参数契约（如 `/?kgPreview=1`）强制预览仅渲染（无工具栏/面板），以防递归与跨模式干扰。编辑区可在 Markdown 与轻量 Graph Table 间切换；选择与焦点需保持 SSOT 对齐。",
        "@language": "zh-cn"
      }
    ],
    "toolbarNavigateMode": [
      {
        "@value": "Toolbar includes a Navigate button that clears selection and forces single-select. It replaces any floating mode rail and must reuse the same canonical selection/mode state.",
        "@language": "en-us"
      },
      {
        "@value": "Toolbar 包含 Navigate 按钮：清空选择并强制单选模式。它替代任何悬浮模式栏，并且必须复用同一份规范选择/模式状态。",
        "@language": "zh-cn"
      }
    ],
    "canvasViewportStatusInStatusPanel": [
      {
        "@value": "Viewport HUD (zoom %, pan x/y, selection count, renderer) must be surfaced only inside the Status Panel. Forbid separate floating HUD or bottom status bars on the canvas.",
        "@language": "en-us"
      },
      {
        "@value": "视口 HUD（缩放百分比、平移 x/y、选择数量、渲染器）只能展示在 Status Panel 内。禁止在画布上再渲染独立的悬浮 HUD 或底部状态栏。",
        "@language": "zh-cn"
      }
    ],
    "editorWorkspaceGraphTable": [
      {
        "@value": "Editor workspace may include a Graph Table section for inspecting the active GraphData. It must use semantic HTML (header/nav/form/table/thead/tbody/th/td), a toolbar for fields/filter/group/sort/row height, and colgroup-based column resizing. Split panes use a vertical hr separator with pointer-drag resize and persisted widths; avoid scroll-jump loops when syncing selection with preview and TOC.",
        "@language": "en-us"
      },
      {
        "@value": "Editor 工作区可包含用于查看当前 GraphData 的 Graph Table 区域。必须使用语义化 HTML（header/nav/form/table/thead/tbody/th/td），并提供字段/过滤/分组/排序/行高工具条与基于 colgroup 的列宽调整。分栏使用可拖拽的垂直 hr 分隔并持久化宽度；与预览与 TOC 同步选择时需避免滚动跳动循环。",
        "@language": "zh-cn"
      }
    ],
    "recordInspectorSsot": [
      {
        "@value": "Record/Selection Inspector (dl/header + field inputs) must be a single host-owned SSOT component reused across Graph Table and the Canvas Floating Panel Inspector view (no legacy right SidePanel). When Flow Editor is the active 2D renderer, its inspector must be consolidated into the same Floating Panel Inspector surface (portal slot) rather than rendering a separate inspector panel.",
        "@language": "en-us"
      },
      {
        "@value": "Record/Selection Inspector（dl/header + 字段输入）必须是宿主唯一的 SSOT 组件，并在 Graph Table 与 Canvas 浮动面板（Floating Panel）的 Inspector 视图中复用（禁止遗留右侧 SidePanel）。当 Flow Editor 为当前 2D 渲染器时，其 Inspector 必须合并到同一 Floating Panel Inspector 表面（portal slot），禁止渲染独立的 Inspector 面板。",
        "@language": "zh-cn"
      }
    ],
    "floatingPanelShellSsot": [
      {
        "@value": "Floating Panel (tool menu) is the only SSOT shell primitive for Canvas panels (semantic structure, header/body structure, and theming). It hosts Props Panel + Inspector/Chat/Geo + Graph Traversal views and forbids any legacy right SidePanel or BottomPanel Orchestrator. Only mount the active view to forbid hidden background work.",
        "@language": "en-us"
      },
      {
        "@value": "Floating Panel（工具菜单）是 Canvas 面板唯一的 SSOT 壳层原语（语义结构、头/体结构、主题）。它承载 Props Panel + Inspector/Chat/Geo + Graph Traversal 视图，并禁止任何遗留右侧 SidePanel 或 BottomPanel Orchestrator。只允许挂载当前激活视图，禁止隐藏面板后台运行。",
        "@language": "zh-cn"
      }
    ],
    "floatingPanelTypographySsot": [
      {
        "@value": "Floating Panel typography (font family + base text size + micro-label size + monospace size) must be SSOT-driven via the host UI settings and applied at the floating panel content root so Inspector/Props/Orchestrator/Chat/Geo surfaces inherit consistently. MainPanel / Editor workspace / Graph Data Table must use the same ladder (anchor = FloatingPanel Inspector). Cross-repo panels mounted inside Floating Panel (e.g. geospatial panel) must receive the same ladder via a typed `panelTypography` prop (`PanelTypography.keyLabelClass` is the canonical Key label class; `PANEL_TYPOGRAPHY_DEFAULTS` centralizes fallbacks). Record Inspector key labels must use the same key/value text size as inputs (no micro-label sizing on `dt`). Portal content (dropdowns/popovers) must apply `microLabelClass` when it cannot inherit. Forbid hardcoded `text-*`/`font-*` inside panel bodies; only semantic emphasis (e.g. bold) is allowed.",
        "@language": "en-us"
      },
      {
        "@value": "Floating Panel 的排版（字体族 + 基础字号 + 微标签字号 + 等宽字号）必须由宿主 UI 设置驱动，并在浮动面板内容根节点统一应用，使 Inspector/Props/Orchestrator/Chat/Geo 表面一致继承。MainPanel / Editor 工作区 / Graph Data Table 也必须使用同一排版阶梯（锚点 = FloatingPanel Inspector）。Floating Panel 内挂载的跨仓库面板（例如 geospatial panel）必须通过类型化的 `panelTypography` prop 获取同一排版阶梯（`PanelTypography.keyLabelClass` 为 Key 标签的规范 class；`PANEL_TYPOGRAPHY_DEFAULTS` 统一默认回退值）。Record Inspector 的 key 标签必须与输入框使用同一 key/value 字号（`dt` 不得使用微标签字号）。无法继承的 Portal 内容（下拉/弹层）必须显式应用 `microLabelClass`。禁止在面板正文中硬编码 `text-*`/`font-*`；只允许语义强调（如加粗）。",
        "@language": "zh-cn"
      }
    ],
    "graphTraversalOrchestratorContract": [
      {
        "@value": "Graph Traversal (Orchestrator) UI must live only in the Canvas Floating Panel Graph Traversal view. Forbid any duplicate Orchestrator UI/Text editors in BottomPanel. Orchestrator configuration text editing must happen in the Editor workspace via workspace files (e.g. `orchestrator/graphrag-workflow.jsonld`); the panel may provide a jump-to-file button but must not embed a second freeform text editor.",
        "@language": "en-us"
      },
      {
        "@value": "Graph Traversal（Orchestrator）UI 只能存在于 Canvas Floating Panel 的 Graph Traversal 视图中。禁止在 BottomPanel 中保留/新增任何重复的 Orchestrator UI/Text 编辑器。Orchestrator 配置的纯文本编辑必须在 Editor 工作区通过工作区文件完成（例如 `orchestrator/graphrag-workflow.jsonld`）；面板可提供跳转按钮，但不得嵌入第二套自由文本编辑器。",
        "@language": "zh-cn"
      }
    ],
    "activeGraphRenderViewSsot": [
      {
        "@value": "All render surfaces (Editor workspace, Graph Data Table, Graph Fields, Selection Inspector (Record Inspector), EXPLORER projections, Canvas Preview, Canvas D3/Flow/2D/3D, Document Mode, and Geospatial 2D/3D) must consume the same SSOT-derived active graph render view. Derivation order: keyword base → optional frontmatter Mermaid filter (document mode only) → optional group collapse (`collapsedGroupIds`). Forbid per-surface re-derivation and drift. Graph Table persistence must reflect this derived view (including collapsed groups) and be validated with a bounded host test.",
        "@language": "en-us"
      },
      {
        "@value": "所有渲染表面（Editor 工作区、Graph Data Table、Graph Fields、Selection Inspector（Record Inspector）、EXPLORER 投影、Canvas Preview、Canvas D3/Flow/2D/3D、Document Mode、Geospatial 2D/3D）必须消费同一份 SSOT 推导的 active graph render view。推导顺序：keyword 基础图 → 可选 frontmatter Mermaid 过滤（仅 document mode）→ 可选 group collapse（`collapsedGroupIds`）。禁止各表面自行二次推导与漂移。Graph Table 的持久化结果必须反映该推导视图（包含 collapsed groups），并通过有界的 host 测试验证。",
        "@language": "zh-cn"
      }
    ],
    "parserSchemaWorkflowSsot": [
      {
        "@value": "Parser and Schema Configurator UI must live only in MainPanel Workflow. Forbid BottomPanel Parser/Schema tabs and any embedded Monaco Text Editors for parser scripts or schema config. Freeform text editing happens only in the Editor workspace via workspace files: `/parser/parser.py` and `/schema/schema.json`. Workspace autosave may sync `/parser/parser.py` into parser state and apply `/schema/schema.json` to the host schema only when JSON parses.",
        "@language": "en-us"
      },
      {
        "@value": "Parser 与 Schema Configurator UI 只能存在于 MainPanel Workflow。禁止 BottomPanel 中存在 Parser/Schema 标签页，且禁止在其中嵌入任何用于 parser script 或 schema 配置的 Monaco 文本编辑器。自由文本编辑只能在 Editor 工作区通过工作区文件完成：`/parser/parser.py` 与 `/schema/schema.json`。工作区自动保存可将 `/parser/parser.py` 同步到 parser state，并仅在 JSON 可解析时将 `/schema/schema.json` 应用到宿主 schema。",
        "@language": "zh-cn"
      }
    ],
    "flowEditorNodeQuickEditorSsot": [
      {
        "@value": "Flow Editor may render an in-canvas Node Quick Editor overlay (positioned near the selected node). The overlay must reuse the host FloatingPanel shell patterns (ARIA + theming) and use semantic HTML only (aside/section/header/nav/menu/form/fieldset/legend/label/input/select/textarea/button), forbidding generic div wrappers. It supports pin/unpin (detach from node), drag when unpinned, minimize/restore, and inherits SSOT `uiPanelOpacity`. Toolbar actions use icon buttons and a click-to-open More menu. Field values map to node.properties keys; validation surfaces missing required keys without mutating graph state on failure.",
        "@language": "en-us"
      },
      {
        "@value": "Flow Editor 可在画布内渲染 Node Quick Editor 覆层（靠近当前选中节点定位）。该覆层必须复用宿主 FloatingPanel 的壳层模式（ARIA + 主题），并仅使用语义化 HTML（aside/section/header/nav/menu/form/fieldset/legend/label/input/select/textarea/button），禁止通用 div 包裹。支持 pin/unpin（从节点脱离）、未 pin 时可拖拽移动、最小化/还原，并继承 SSOT 的 `uiPanelOpacity`。工具条使用图标按钮与点击展开的 More 菜单。字段值映射到 node.properties；校验需提示缺失必填键，失败时不得修改图状态。",
        "@language": "zh-cn"
      }
    ],
    "spreadsheetGridStorageBackend": [
      {
        "@value": "Spreadsheet grid uses AG Grid for rich Airtable-like interactions and RxDB+Dexie as the local-first persistence layer. Forbid hosted backends and registration/auth flows. Stream row/column changes from RxDB and avoid re-render churn by keeping stable row ids and column ids.",
        "@language": "en-us"
      },
      {
        "@value": "Spreadsheet 表格使用 AG Grid 提供类 Airtable 的交互能力，并使用 RxDB+Dexie 作为本地优先的持久化层。禁止托管后端与注册/认证流程。行/列变更应从 RxDB 流式推送，并通过稳定的 rowId/columnId 避免渲染抖动。",
        "@language": "zh-cn"
      }
    ]
  }
}
