{
  "@context": "https://huijoohwee.github.io/schema/AgenticRAG/v1/context.jsonld",
  "@id": "rag:Workflow",
  "@type": "rdfs:Class",
  "schemaVersion": "1.1.5",
  "rdfs:label": [
    { "@value": "Workflow", "@language": "en-us" },
    { "@value": "工作流", "@language": "zh-cn" }
  ],
  "rdfs:comment": [
    {
      "@value": "Defines the structural contract for workflow-oriented UI surfaces (for example MainPanel Workflow Manager). Guidance copy should be low-verbosity in-layout and exposed via Role \u2192 Actions \u2192 Outcome tooltips, keeping the workflow step ordering reproducible and domain-agnostic.",
      "@language": "en-us"
    },
    {
      "@value": "定义工作流类 UI 界面的结构化契约（例如主面板 Workflow Manager）。指导文案应在布局中保持低冗余，并通过 Role \u2192 Actions \u2192 Outcome 工具提示呈现，使工作流步骤顺序可复现且领域无关。",
      "@language": "zh-cn"
    }
  ],
  "workflowUiGuidelines": {
    "tooltipSemantics": "Role \u2192 Actions \u2192 Outcome",
    "maxWords": 50,
    "reduceVerbosityInLayout": true,
    "oneRowHeaders": true,
    "controlHeight": "h-7",
    "statusPillHeight": "h-6",
    "toolAreaSectionPadding": "px-2 py-1",
    "workflowStep3Ingest": {
      "subsections": ["Sample Dataset", "Dataset fetch limits", "Source Files"],
      "datasetFetchLimits": {
        "layout": "keyValueRows",
        "rowRule": "One key/value per row; reuse MainPanel Settings Key/Value primitives; keep the value control right-aligned and height-aligned with other controls. These limits must be applied to bounded URL fetches and local file reads (including Source Files URL import and editor preview fetch) to avoid relying on small shared defaults."
      },
      "layoutRule": "All Step 3 subsections must share the same left/right padding and sticky header styling (do not render an out-of-band Sample Dataset block outside the Step 3 subsection stack).",
      "sourceFiles": {
        "canonicalSurface": "BottomPanel.Curation.Markdown",
        "workflowSurfaceRule": "Workflow Step 3 must not render a duplicate Source Files management table. It may only provide a single Open Markdown action that routes to the canonical Source Files surface."
      }
    },
    "sourceFilesIngestSurface": {
      "canonicalSurface": "BottomPanel.Curation.Markdown",
      "sidebarSection": "Source Files",
      "toolbarActions": ["Import local", "Import URL", "Import website", "Open in editor", "Export", "Clear", "Status"],
      "supportedImportFormats": [".md", ".markdown", ".txt", ".geojson", ".json", ".jsonld", ".csv", ".html", ".htm", ".yaml", ".yml", ".pdf", "YouTube"],
      "supportedExportFormats": [".md", ".txt", ".geojson", ".json", ".jsonld", ".csv", ".html", ".yaml"],
      "selectionRule": "Toolbar actions apply to the active Source File selected in the Source Files sidebar. If no file is active, Import actions must create a new Source File and make it active.",
      "urlInputRule": "URL import input is hidden by default and expands leftwards from the URL icon; Enter submits; Escape closes.",
      "webpageViews": {
        "activeRowDropdown": ["Markdown", "JSON", "HTML", "Wireframe"],
        "frontmatterKeys": ["kgWebpageUrl", "kgWebpageView"],
        "viewOnlyRule": "Switching view modes must be strictly view-only: forbid apply-to-graph, layout reseeds, zoom jumps, and layer mutations.",
        "iframeRenderMode": {
          "settingKey": "webpageHtmlIframeMode",
          "default": "srcdoc",
          "modes": ["srcdoc", "src"],
          "srcdocRule": "Render HTML in a sandboxed iframe using srcdoc populated from stored rawHtml artifacts when available, else from the same-origin proxy HTML; srcdoc must upsert <base> and strip CSP meta tags to avoid self-blocking.",
          "srcRule": "Render HTML in a sandboxed iframe using src=\"/__webpage_proxy?url=...\"."
        },
        "iframeSecurityPolicy": {
          "sandbox": "allow-scripts allow-forms allow-popups allow-downloads allow-modals allow-pointer-lock allow-presentation",
          "referrerPolicy": "no-referrer",
          "forbid": ["allow-top-navigation"]
        },
        "modeContract": {
          "markdown": "Editor shows Markdown; Viewer/Presentation/Slides render Markdown.",
          "json": "Editor shows conversion JSON (read-only); Viewer/Presentation/Slides render HTML via iframe proxy.",
          "html": "Editor shows Markdown; Viewer/Presentation/Slides render HTML via iframe proxy.",
          "wireframe": "Editor shows ASCII wireframe (read-only); Viewer/Presentation/Slides render HTML via iframe proxy."
        }
      },
      "websiteImport": {
        "triggerRule": "In the Import URL UI, the Globe button triggers website import (sitemap/tree crawl).",
        "workspaceTreeRule": "Website import writes one stub Markdown file per page under /websites/<host>/<importId>/... to mirror URL path structure.",
        "frontmatterKeys": ["kgWebpageUrl", "kgWebpageView", "kgWebsiteImportId", "kgWebsiteNodeId", "kgWebsiteOutputDirRel"],
        "artifactKinds": ["rawHtml", "markdown", "conversionJson", "wireframeMarkdown"],
        "artifactMappingRule": "For website-import pages, editor view→artifact maps as json→conversionJson, wireframe→wireframeMarkdown, else markdown.",
        "htmlFidelityRule": "For view modes json/html/wireframe, Viewer/Presentation/Slides must render 100% fidelity HTML via a sandboxed iframe; prefer stored rawHtml artifacts and fall back to the same-origin iframe proxy; editor stays Markdown/JSON/Wireframe as selected.",
        "optionsRule": "Website import must persist markdown/conversionJson/wireframeMarkdown artifacts per page and must accept a wireframeDetailLevel option for deterministic wireframe LOD."
      }
    }
  }
}
