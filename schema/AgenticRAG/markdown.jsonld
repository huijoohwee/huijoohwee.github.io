{
  "@context": "https://huijoohwee.github.io/schema/AgenticRAG/v1/context.jsonld",
  "@id": "rag:Markdown",
  "@type": "rdfs:Class",
  "schemaVersion": "1.0.10",
  "rdfs:label": [
    { "@value": "Markdown", "@language": "en-us" },
    { "@value": "Markdown", "@language": "zh-cn" }
  ],
  "rdfs:comment": [
    {
      "@value": "Describes Markdown documents used as neutral, dataset-agnostic inputs and exports for AgenticRAG workflows. Markdown content remains schema-agnostic; pipelines map sections and code blocks into GraphRAG-friendly nodes, edges, and chunk_text while keeping JSON-LD graphs and canvas views structurally aligned. In Canvas, the Bottom Panel Markdown Editor/Viewer keeps source text and preview together, renders preview using GFM-first markdown tokenization with a CommonMark-style fallback, supports word wrap and a slide-style Presentation Mode, and anchors selection back to document line ranges via metadata.documentPath and metadata.lineStart/metadata.lineEnd (with provenance tracked via metadata.timestamp and optional metadata.documentUrl). Token sharing is implemented between the Editor (TOC generation) and Viewer (Preview rendering) to avoid redundant lexing, ensuring optimal performance during mode switches; Presentation Mode renderers should key tokens by documentPath + line ranges to prevent per-slide state leakage. When composing chat context, Canvas may expand a selected node’s line range to a section-aware excerpt bounded by Markdown headings (ATX `#`…`######` and Setext), avoids breaking fenced code blocks, and trims to a small character budget (~2000 chars). Presentation Mode supports Slidev-style slide splitting using standalone `---` separators (outside code fences), an optional MDX evaluation path for embedding safe JSX components inside slides, and zoomable full-screen inspection for Mermaid diagrams. Preview rendering may optionally promote safe rich media embeds (images, video links, and common iframe providers) without requiring schema changes to the Markdown content. For fenced code blocks, implementations may expose a single global Beside/Inline/Render mode in the Markdown Viewer header so all code blocks follow the same layout; per-block overrides may exist but should clear automatically when they match the global mode so future global changes apply. Selecting Render may also enable frontmatter visibility for documents that start with YAML frontmatter. Render mode fits supported previews (e.g., Mermaid diagrams, GeoJSON via MapLibre) into the full code block area. GeoJSON rendering may default to Render for `geojson` blocks and for `json` blocks when an integration detects GeoJSON content; map previews may follow the same overlay conventions as Mermaid (fullscreen overlay in container-scope, open Geospatial panel in viewport-scope). Mermaid code blocks may optionally include a leading YAML `--- ... ---` header to configure that block’s Mermaid init settings. Render mode should reuse the Geospatial Mode basemap style configuration while deferring map initialization until visible to reduce memory/render overhead. Canvas may also ingest external sources (e.g., PDF/HTML/YouTube transcripts) by converting them into Markdown while preserving provenance via metadata.documentUrl. When Geospatial Mode is available, implementations may optionally extract embedded fenced `geojson` code blocks (GeoJSON FeatureCollection) from local Markdown inputs and register them as bounded overlay dataset layers without hardcoding any external URLs.",
      "@language": "en-us"
    },
    {
      "@value": "用于 AgenticRAG 工作流的 Markdown 文档类型，强调中立、与数据集无关的输入与导出形式。Markdown 内容本身不携带特定模式假设，流水线将段落和代码块映射为适合 GraphRAG 的节点、边和 chunk_text，同时保持 JSON‑LD 图和画布视图在结构上的一致性。Canvas 的 Bottom Panel Markdown Editor/Viewer 提供 Markdown 源文本编辑与预览，使用以 GFM 为优先的 Markdown 分词与接近 CommonMark 的回退策略渲染预览，支持 Word Wrap 与幻灯片式 Presentation Mode，并通过 metadata.documentPath 与 metadata.lineStart/metadata.lineEnd 将选中节点/边锚定回文档行区间（来源信息通过 metadata.timestamp 以及可选的 metadata.documentUrl 记录）。在编辑器（TOC 生成）和预览器（渲染）之间实现了 Token 共享，以避免模式切换时的冗余词法分析，确保最佳性能；在 Presentation Mode 中应使用 documentPath + 行区间作为渲染 key 以避免跨幻灯片的状态泄漏。 在构建聊天上下文时，Canvas 可将选中节点的行区间扩展为基于 Markdown 标题边界的片段（ATX `#`…`######` 与 Setext），避免在 fenced code block 内截断，并裁剪到较小的字符预算（约 2000 字符）。Presentation Mode 支持 Slidev 风格的独立 `---` 分隔符（代码块外）分页、可选的 MDX 求值以在幻灯片中嵌入安全的 JSX 组件，以及 Mermaid 图的可缩放全屏查看。预览渲染可选地将安全的富媒体嵌入（图片、视频链接、常见 iframe 提供方）提升为可视内容，而无需修改 Markdown 内容的 schema。对于 fenced 代码块，实现可在 Markdown Viewer 头部提供全局 Beside/Inline/Render 模式，使所有代码块遵循同一布局；同时允许单块覆盖，但当单块模式与全局模式重新一致时应自动清除覆盖状态，以便后续全局切换继续生效。选择 Render 时也可为以 YAML frontmatter 开头的文档自动启用 frontmatter 可见性。Render 模式将支持的预览（例如 Mermaid 图、通过 MapLibre 渲染的 GeoJSON）适配并铺满代码块区域；其中 `geojson` 代码块可默认进入 Render，而 `json` 代码块在识别为 GeoJSON 内容时也可默认进入 Render；GeoJSON 地图预览也可复用 Mermaid 的交互约定（容器范围用全屏 Overlay 查看，视口范围打开地理空间面板）。Mermaid 代码块可在内容开头放置 YAML `--- ... ---` 头部，用于配置该代码块的 Mermaid 初始化设置。Render 模式应复用地理空间模式的底图样式配置且将地图初始化延后到可见时以降低内存/渲染开销。Canvas 也可将外部来源（如 PDF/HTML/YouTube 字幕）转换为 Markdown 进行摄取，并通过 metadata.documentUrl 保留溯源。当可用地理空间模式时，实现也可以选择性地从本地 Markdown 输入中提取内嵌 fenced `geojson` 代码块（GeoJSON FeatureCollection），并以有界方式注册为叠加层数据集图层，且不得硬编码任何外部 URL。",
      "@language": "zh-cn"
    }
  ]
}
